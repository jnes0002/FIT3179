{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "title": "Australia Major Aiport Traffic (Domestic Inbound & Outbound)",
  "width": 800,
  "height": 600,
  "projection": {"type": "mercator"},
  
  "params": [
  {
    "name": "TimeIndex",
    "value": 1,
    "bind": {
      "input": "range",
      "min": 1,
      "max": 198,
      "step": 1,
      "name": "Month-Year: "
    } 
  }
  ],



  "layer": [
    {
      "data": {
        "url": "Australia_Topo.json",
        "format": {"type": "topojson", "feature": "AUS_2016_AUST"}
    },
      "mark": {"type": "geoshape","fill": "lightgray","stroke": "white"}
      },
    {
  "data": {
  "url": "airport_traffic.csv"
},
"transform": [
  { "filter": "datum.Time_Index == TimeIndex" },
  {
    "lookup": "IATA_CODE",
    "from": {
      "data": { "url": "au-major-airports.csv" },
      "key": "iata_code",
      "fields": ["longitude_deg", "latitude_deg", "name"]
    }
  },
  {
  "calculate": "timeFormat(datetime(datum.Year, datum.Month - 1, 1), '%b %Y')",
  "as": "MonthLabel"
  }
],
"mark": { "type": "circle", "color": "red" },
"encoding": {
  "longitude": { "field": "longitude_deg", "type": "quantitative" },
  "latitude": { "field": "latitude_deg", "type": "quantitative" },
  "size": {
    "field": "TOTAL_DOM",
    "type": "quantitative",
    "scale": { "domain": [0, 2000000],"range": [50, 1000] }
  },
  "tooltip": [
    { "field": "name", "type": "nominal" },
    { "field": "TOTAL_DOM", "type": "quantitative", "title": "Passengers" },
    { "field": "Year", "type": "ordinal" },
    { "field": "Month", "type": "ordinal" }
  ]
}
},
{
  "data": {
    "url": "airport_traffic.csv"
  },
  "transform": [
    { "filter": "datum.Time_Index == TimeIndex" },
    {
      "calculate": "timeFormat(datetime(datum.Year, datum.Month - 1, 1), '%b %Y')",
      "as": "MonthLabel"
    }
  ],
  "mark": {
    "type": "text",
    "fontSize": 16,
    "align": "left",
    "baseline": "top"
  },
  "encoding": {
    "text": { "field": "MonthLabel", "type": "nominal" },
    "x": { "value": 20 },
    "y": { "value": 580 }
  }
}
    ]
    }
    

